boxplot(datos$Price, main="PRICE")
boxplot(datos$KM, main="KM")
boxplot(datos$Age_08_04, main="AGE-08-04")
boxplot(datos$Mfg_Month, main="MFG-MONTH")
boxplot(datos$Mfg_Year, main="MFG-YEAR")
#boxplot(datos$Fuel_Type, main="FUEL-TYPE")
boxplot(datos$HP, main="HP")
boxplot(datos$Met_Color, main="MET-COLOR")
boxplot(datos$Automatic, main="AUTOMATIC")
boxplot(datos$cc, main="CC")
boxplot(datos$Doors, main="DOORS")
boxplot(datos$Cylinders, main="CYLINDERS")
boxplot(datos$Gears, main="GEARS")
boxplot(datos$Quarterly_Tax, main="QUARTELY-TAX")
boxplot(datos$Weight, main="WEIGHT")
boxplot(datos$Mfr_Guarantee, main="MFR-GUARANTEE")
boxplot(datos$Guarantee_Period, main="GUARANTEE-PERIOD")
boxplot(datos$ABS, main="ABS")
boxplot(datos$Airbag_1, main="AIRBAG-1")
boxplot(datos$Airbag_2, main="AIRBAG-2")
boxplot(datos$Airco, main="AIRCO")
boxplot(datos$BOVAG_Guarantee, main="BOVAG-GUARANTEE")
boxplot(datos$Automatic_airco, main="AUTOMATIC")
boxplot(datos$Boardcomputer, main="BOARDCOMPUTER")
boxplot(datos$CD_Player, main="CD-PLAYER")
boxplot(datos$Central_Lock, main="CENTRAL-LOCK")
boxplot(datos$Powered_Windows, main="POWERED-WINDOWS")
boxplot(datos$Power_Steering, main="POWERED-STEERING")
boxplot(datos$Radio, main="RADIO")
boxplot(datos$Mistlamps, main="MISTLAMPS")
boxplot(datos$Sport_Model, main="SPORT-MODEL")
boxplot(datos$Backseat_Divider, main="BACKSEAT-DIVIDER")
boxplot(datos$Metallic_Rim, main="METALLIC-RIM")
boxplot(datos$Radio_cassette, main="RADIO-CASSETTE")
boxplot(datos$Tow_Bar, main="TOW-BAR")
dataset = datos[c("Price", "KM", "Age_08_04", "HP", "cc", "Doors", "Gears", "Weight",
"Fuel_Type", "Central_Lock", "Powered_Windows","Automatic_airco")]
#dataset1 = deleteme[c("Price", "KM", "Age_08_04", "HP", "cc", "Doors", "Gears", "Weight", "Fuel_Type", "Central_Lock", "Powered_Windows")]
mlr <- lm(formula = Price ~ ., data = dataset)
summary(mlr)
dataset1 <- dataset[c("Price", "KM", "Age_08_04", "HP", "cc", "Doors", "Gears", "Weight",
"Powered_Windows","Automatic_airco")]
mlr2 <- lm(formula = Price ~ ., data =  dataset1)
summary(mlr2)
dataset3 <- dataset1[c("Price", "KM", "Age_08_04", "HP", "cc", "Gears", "Weight",
"Powered_Windows","Automatic_airco")]
mlr4 <- lm(formula = Price ~ ., data =  dataset3)
summary(mlr4)
dataset4 <- dataset3[c("Price", "KM", "Age_08_04", "HP","Gears", "Weight",
"Powered_Windows","Automatic_airco")]
mlr5 <- lm(formula = Price ~ ., data = dataset4)
summary(mlr5)
stem(mlr5$residuals)
plot(predict(mlr5), datos$Price, ylab = "Price" , main = "Valores predecidos vs actuales")
abline(a=0,b=1, col="blue", lwd=2)
plot(residuals(mlr5))
abline(a=0,b=0, col="blue", lwd =2)
hist(mlr5$residuals , main = "Histograma de residuales", freq = F)
lines(density(mlr5$residuals), col="red", lwd=2)
plot(mlr5$residuals ~ datos$Price)
abline(a=0,b=0, col = "blue", lwd=2)
qqnorm(mlr5$residuals)
qqline(mlr$residuals, col = "blue ", lwd=2)
plot(mlr5)
ggplot(dataset4, aes(x=KM, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs KM")
ggplot(dataset4, aes(x=Age_08_04, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs Age_08_04")
ggplot(dataset4, aes(x=HP, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs HP")
ggplot(dataset4, aes(x=Weight, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs Weight")
ggplot(dataset4, aes(x=Powered_Windows, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs Powered_Windows")
ggplot(dataset4, aes(x=Automatic_airco, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs Automatic_airco")
#dataset2 <- dataset[c("Price", "KM", "Age_08_04", "HP","cc","Gears", "Weight","Powered_Windows","Automatic_airco")]
#mlr3 <- lm(formula = Price ~ ., data =  dataset2)
#summary(mlr3)
#plot(mlr3)
dataset4 <- filter(dataset4, !(Weight>1200))
dataset4 <- filter(dataset4,  !(KM>150000))
dataset4 <- filter(dataset4, !(KM<15))
dataset4 <- filter(dataset4, !(HP>150))
dataset4 <- filter(dataset4, !(Age_08_04<20))
skewness(dataset4)
multi.hist(dataset4, dcol = c("blue ", "red"), dlty = c("dotted", "solid"), main = "")
pairs(dataset4)
data_correlation <- cor(dataset4)
data_correlation
corrplot(data_correlation, method="square")
dataset5 <- dataset4[c("Price", "KM", "Age_08_04", "Weight","HP",
"Powered_Windows", "Automatic_airco")]
mlr6 <- lm(formula = Price ~ ., data = dataset5)
summary(mlr6)
step(mlr6, direction = "both", trace = 1)
split_data <- createDataPartition(y= dataset5$Price, p=0.7, list= FALSE)
train_data <- dataset5[split_data,]
test_data <- dataset5[-split_data,]
lmfit1 <- train(Price ~ ., data = train_data, method="lm")
summary(lmfit1)
predict_test <- predict(lmfit1, test_data)
model_test_1 <- data.frame(obs= test_data$Price, pred = predict_test)
defaultSummary(model_test_1)
control1 <- trainControl(method="cv", number=10)
lmfit2 <- train(Price ~ ., data= dataset5, method="lm", trControl= control1, metric = "Rsquared")
summary(lmfit2)
predict_test2 <- predict(lmfit2, dataset5)
model_test_2 <- data.frame(obs=dataset5$Price, pred = predict_test2)
defaultSummary(model_test_2)
control2 <- trainControl(method= "LOOCV")
lmfit3 <- train(Price ~ ., data = dataset5, method="lm", trControl=control2)
summary(lmfit3)
predict_test3 <- predict(lmfit3, dataset5)
model_test_3 <- data.frame(obs= dataset5$Price, pred= predict_test3)
defaultSummary(model_test_3)
ggplot(varImp(lmfit3))
library("dplyr")
library("gdata")
library("corrplot")
library("moments")
library("fastDummies")
library("ggplot2")
library("psych")
library("car")
library("corrplot")
library("caret")
datos = read.csv("ToyotaCorolla.csv")
head(datos,20)
str(datos)
deleteme = datos
deleteme$Fuel_Type = as.factor(datos$Fuel_Type)
deleteme$Mfg_Month =  as.factor(datos$Mfg_Month)
deleteme$Mfg_Year = as.factor(datos$Mfg_Year)
deleteme$Met_Color = as.factor(datos$Met_Color)
deleteme$Automatic = as.factor(datos$Automatic)
deleteme$Doors = as.factor(datos$Doors)
deleteme$Cylinders = as.factor(datos$Cylinders)
deleteme$Gears = as.factor(datos$Gears)
deleteme$Mfr_Guarantee = as.factor(datos$Mfr_Guarantee)
deleteme$BOVAG_Guarantee = as.factor(datos$BOVAG_Guarantee)
deleteme$Guarantee_Period = as.factor(datos$Guarantee_Period)
deleteme$ABS = as.factor(datos$ABS)
deleteme$Airbag_1 = as.factor(datos$Airbag_1)
deleteme$Airbag_2 = as.factor(datos$Airbag_2)
deleteme$Airco = as.factor(datos$Airco)
deleteme$Automatic_airco = as.factor(datos$Automatic_airco)
deleteme$Boardcomputer = as.factor(datos$Boardcomputer)
deleteme$CD_Player = as.factor(datos$CD_Player)
deleteme$Central_Lock = as.factor(datos$Central_Lock)
deleteme$Power_Windows = as.factor(datos$Powered_Windows)
deleteme$Power_Steering = as.factor(datos$Power_Steering)
deleteme$Radio = as.factor(datos$Radio)
deleteme$Mistlamps = as.factor(datos$Mistlamps)
deleteme$Sport_Model = as.factor(datos$Sport_Model)
deleteme$Backseat_Divider = as.factor(datos$Backseat_Divider)
deleteme$Metallic_Rim = as.factor(datos$Metallic_Rim)
deleteme$Radio_cassette = as.factor(datos$Radio_cassette)
deleteme$Tow_Bar = as.factor(datos$Tow_Bar)
str(deleteme)
summary(deleteme)
boxplot(deleteme$Age_08_04, main="Age_08_04")
pie(summary(deleteme$Mfg_Month), main = "MFG-MONTH"  )
boxplot(deleteme$Price, main = "Price")
pie(summary(deleteme$Mfg_Year), labels = c("1998","1999","2000","2001", "2001", "2002", "2003", "2004","otro"), main = "MFG-YEAR")
boxplot(deleteme$KM, main = "KM")
pie(summary(deleteme$Fuel_Type), labels = c("GNC", "DIESEL", "PETROL"), main ="FUEL-TYPE")
boxplot(deleteme$HP, main = "HP")
pie(summary(deleteme$Met_Color), labels = c("SI", "NO"), main = "MET-COLOR")
pie(summary(deleteme$Automatic), labels = c("SI", "NO"), main = "AUTOMATIC")
boxplot(deleteme$cc, main="CC")
pie(summary(deleteme$Doors), labels = c("2", "3", "4", "5"), main = "DOORS")
pie(summary(deleteme$Cylinders), labels =c("4", "otro"), main =  "CYLINDERS")
pie(summary(deleteme$Gears), labels = c("3", "4", "5", "6"), main = "GEARS")
boxplot(deleteme$Quarterly_Tax, main = "QUARTERLY-TAX")
boxplot(deleteme$Weight, main = "WEIGHT")
pie(summary(deleteme$Mfr_Guarantee), labels = c("SI", "NO"), main = "MFR-GUARANTE")
pie(summary(deleteme$BOVAG_Guarantee), labels = c("SI", "NO"), main = "BOVAG-GUARANTE")
pie(summary(deleteme$Guarantee_Period), main="GUARANTE-PERIOD")
pie(summary(deleteme$ABS), main="ABS")
pie(summary(deleteme$Airbag_1), main = "AIRBAG-1")
pie(summary(deleteme$Airbag_2), main = "AIRBAG-2")
pie(summary(deleteme$Airco), main = "AIRCO")
pie(summary(deleteme$Automatic_airco), main = "AUTOMATIC-AIRCO")
pie(summary(deleteme$Boardcomputer), main = "BOARDCOMPUTER")
pie(summary(deleteme$CD_Player), main = "CD-PLAYER")
pie(summary(deleteme$Central_Lock), main = "CENTRAL-LOCK")
pie(summary(deleteme$Powered_Windows), main = "POWERED-WINDOWS")
pie(summary(deleteme$Power_Steering), main = "POWER-STEERING")
pie(summary(deleteme$Radio), main = "RADIO")
pie(summary(deleteme$Mistlamps), main = "MITSLAMPS")
pie(summary(deleteme$Sport_Model), main = "SPORT-MODEL")
pie(summary(deleteme$Backseat_Divider), main = "BACKSEAT-DIVIDER")
pie(summary(deleteme$Metallic_Rim), main = "METALIC-RIM")
pie(summary(deleteme$Radio_cassette), main = "RADIO-CASSETTE")
pie(summary(deleteme$Tow_Bar), main = "TOW-BAR")
pie(summary(deleteme$Power_Windows), main = "POWER-WINDOWS")
boxplot(datos$Price, main="PRICE")
boxplot(datos$KM, main="KM")
boxplot(datos$Age_08_04, main="AGE-08-04")
boxplot(datos$Mfg_Month, main="MFG-MONTH")
boxplot(datos$Mfg_Year, main="MFG-YEAR")
#boxplot(datos$Fuel_Type, main="FUEL-TYPE")
boxplot(datos$HP, main="HP")
boxplot(datos$Met_Color, main="MET-COLOR")
boxplot(datos$Automatic, main="AUTOMATIC")
boxplot(datos$cc, main="CC")
boxplot(datos$Doors, main="DOORS")
boxplot(datos$Cylinders, main="CYLINDERS")
boxplot(datos$Gears, main="GEARS")
boxplot(datos$Quarterly_Tax, main="QUARTELY-TAX")
boxplot(datos$Weight, main="WEIGHT")
boxplot(datos$Mfr_Guarantee, main="MFR-GUARANTEE")
boxplot(datos$Guarantee_Period, main="GUARANTEE-PERIOD")
boxplot(datos$ABS, main="ABS")
boxplot(datos$Airbag_1, main="AIRBAG-1")
boxplot(datos$Airbag_2, main="AIRBAG-2")
boxplot(datos$Airco, main="AIRCO")
boxplot(datos$BOVAG_Guarantee, main="BOVAG-GUARANTEE")
boxplot(datos$Automatic_airco, main="AUTOMATIC")
boxplot(datos$Boardcomputer, main="BOARDCOMPUTER")
boxplot(datos$CD_Player, main="CD-PLAYER")
boxplot(datos$Central_Lock, main="CENTRAL-LOCK")
boxplot(datos$Powered_Windows, main="POWERED-WINDOWS")
boxplot(datos$Power_Steering, main="POWERED-STEERING")
boxplot(datos$Radio, main="RADIO")
boxplot(datos$Mistlamps, main="MISTLAMPS")
boxplot(datos$Sport_Model, main="SPORT-MODEL")
boxplot(datos$Backseat_Divider, main="BACKSEAT-DIVIDER")
boxplot(datos$Metallic_Rim, main="METALLIC-RIM")
boxplot(datos$Radio_cassette, main="RADIO-CASSETTE")
boxplot(datos$Tow_Bar, main="TOW-BAR")
dataset = datos[c("Price", "KM", "Age_08_04", "HP", "cc", "Doors", "Gears", "Weight",
"Fuel_Type", "Central_Lock", "Powered_Windows","Automatic_airco")]
#dataset1 = deleteme[c("Price", "KM", "Age_08_04", "HP", "cc", "Doors", "Gears", "Weight", "Fuel_Type", "Central_Lock", "Powered_Windows")]
mlr <- lm(formula = Price ~ ., data = dataset)
summary(mlr)
dataset1 <- dataset[c("Price", "KM", "Age_08_04", "HP", "cc", "Doors", "Gears", "Weight",
"Powered_Windows","Automatic_airco")]
mlr2 <- lm(formula = Price ~ ., data =  dataset1)
summary(mlr2)
dataset3 <- dataset1[c("Price", "KM", "Age_08_04", "HP", "cc", "Gears", "Weight",
"Powered_Windows","Automatic_airco")]
mlr4 <- lm(formula = Price ~ ., data =  dataset3)
summary(mlr4)
dataset4 <- dataset3[c("Price", "KM", "Age_08_04", "HP","Gears", "Weight",
"Powered_Windows","Automatic_airco")]
mlr5 <- lm(formula = Price ~ ., data = dataset4)
summary(mlr5)
stem(mlr5$residuals)
plot(predict(mlr5), datos$Price, ylab = "Price" , main = "Valores predecidos vs actuales")
abline(a=0,b=1, col="blue", lwd=2)
plot(residuals(mlr5))
abline(a=0,b=0, col="blue", lwd =2)
hist(mlr5$residuals , main = "Histograma de residuales", freq = F)
lines(density(mlr5$residuals), col="red", lwd=2)
plot(mlr5$residuals ~ datos$Price)
abline(a=0,b=0, col = "blue", lwd=2)
qqnorm(mlr5$residuals)
qqline(mlr$residuals, col = "blue ", lwd=2)
plot(mlr5)
ggplot(dataset4, aes(x=KM, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs KM")
ggplot(dataset4, aes(x=Age_08_04, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs Age_08_04")
ggplot(dataset4, aes(x=HP, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs HP")
ggplot(dataset4, aes(x=Weight, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs Weight")
ggplot(dataset4, aes(x=Powered_Windows, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs Powered_Windows")
ggplot(dataset4, aes(x=Automatic_airco, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs Automatic_airco")
#dataset2 <- dataset[c("Price", "KM", "Age_08_04", "HP","cc","Gears", "Weight","Powered_Windows","Automatic_airco")]
#mlr3 <- lm(formula = Price ~ ., data =  dataset2)
#summary(mlr3)
#plot(mlr3)
dataset4 <- filter(dataset4, !(Weight>1200))
dataset4 <- filter(dataset4,  !(KM>150000))
dataset4 <- filter(dataset4, !(KM<15))
dataset4 <- filter(dataset4, !(HP>150))
dataset4 <- filter(dataset4, !(Age_08_04<20))
skewness(dataset4)
multi.hist(dataset4, dcol = c("blue ", "red"), dlty = c("dotted", "solid"), main = "")
pairs(dataset4)
data_correlation <- cor(dataset4)
data_correlation
corrplot(data_correlation, method="square")
dataset5 <- dataset4[c("Price", "KM", "Age_08_04", "Weight","HP",
"Powered_Windows", "Automatic_airco")]
mlr6 <- lm(formula = Price ~ ., data = dataset5)
summary(mlr6)
step(mlr6, direction = "both", trace = 1)
split_data <- createDataPartition(y= dataset5$Price, p=0.7, list= FALSE)
train_data <- dataset5[split_data,]
test_data <- dataset5[-split_data,]
lmfit1 <- train(Price ~ ., data = train_data, method="lm")
summary(lmfit1)
predict_test <- predict(lmfit1, test_data)
model_test_1 <- data.frame(obs= test_data$Price, pred = predict_test)
defaultSummary(model_test_1)
control1 <- trainControl(method="cv", number=10)
lmfit2 <- train(Price ~ ., data= dataset5, method="lm", trControl= control1, metric = "Rsquared")
summary(lmfit2)
predict_test2 <- predict(lmfit2, dataset5)
model_test_2 <- data.frame(obs=dataset5$Price, pred = predict_test2)
defaultSummary(model_test_2)
control2 <- trainControl(method= "LOOCV")
lmfit3 <- train(Price ~ ., data = dataset5, method="lm", trControl=control2)
summary(lmfit3)
predict_test3 <- predict(lmfit3, dataset5)
model_test_3 <- data.frame(obs= dataset5$Price, pred= predict_test3)
defaultSummary(model_test_3)
ggplot(varImp(lmfit3))
library("dplyr")
library("gdata")
library("corrplot")
library("moments")
library("fastDummies")
library("ggplot2")
library("psych")
library("car")
library("corrplot")
library("caret")
datos = read.csv("ToyotaCorolla.csv")
head(datos,20)
str(datos)
deleteme = datos
deleteme$Fuel_Type = as.factor(datos$Fuel_Type)
deleteme$Mfg_Month =  as.factor(datos$Mfg_Month)
deleteme$Mfg_Year = as.factor(datos$Mfg_Year)
deleteme$Met_Color = as.factor(datos$Met_Color)
deleteme$Automatic = as.factor(datos$Automatic)
deleteme$Doors = as.factor(datos$Doors)
deleteme$Cylinders = as.factor(datos$Cylinders)
deleteme$Gears = as.factor(datos$Gears)
deleteme$Mfr_Guarantee = as.factor(datos$Mfr_Guarantee)
deleteme$BOVAG_Guarantee = as.factor(datos$BOVAG_Guarantee)
deleteme$Guarantee_Period = as.factor(datos$Guarantee_Period)
deleteme$ABS = as.factor(datos$ABS)
deleteme$Airbag_1 = as.factor(datos$Airbag_1)
deleteme$Airbag_2 = as.factor(datos$Airbag_2)
deleteme$Airco = as.factor(datos$Airco)
deleteme$Automatic_airco = as.factor(datos$Automatic_airco)
deleteme$Boardcomputer = as.factor(datos$Boardcomputer)
deleteme$CD_Player = as.factor(datos$CD_Player)
deleteme$Central_Lock = as.factor(datos$Central_Lock)
deleteme$Power_Windows = as.factor(datos$Powered_Windows)
deleteme$Power_Steering = as.factor(datos$Power_Steering)
deleteme$Radio = as.factor(datos$Radio)
deleteme$Mistlamps = as.factor(datos$Mistlamps)
deleteme$Sport_Model = as.factor(datos$Sport_Model)
deleteme$Backseat_Divider = as.factor(datos$Backseat_Divider)
deleteme$Metallic_Rim = as.factor(datos$Metallic_Rim)
deleteme$Radio_cassette = as.factor(datos$Radio_cassette)
deleteme$Tow_Bar = as.factor(datos$Tow_Bar)
str(deleteme)
summary(deleteme)
boxplot(deleteme$Age_08_04, main="Age_08_04")
pie(summary(deleteme$Mfg_Month), main = "MFG-MONTH"  )
boxplot(deleteme$Price, main = "Price")
pie(summary(deleteme$Mfg_Year), labels = c("1998","1999","2000","2001", "2001", "2002", "2003", "2004","otro"), main = "MFG-YEAR")
boxplot(deleteme$KM, main = "KM")
pie(summary(deleteme$Fuel_Type), labels = c("GNC", "DIESEL", "PETROL"), main ="FUEL-TYPE")
boxplot(deleteme$HP, main = "HP")
pie(summary(deleteme$Met_Color), labels = c("SI", "NO"), main = "MET-COLOR")
pie(summary(deleteme$Automatic), labels = c("SI", "NO"), main = "AUTOMATIC")
boxplot(deleteme$cc, main="CC")
pie(summary(deleteme$Doors), labels = c("2", "3", "4", "5"), main = "DOORS")
pie(summary(deleteme$Cylinders), labels =c("4", "otro"), main =  "CYLINDERS")
pie(summary(deleteme$Gears), labels = c("3", "4", "5", "6"), main = "GEARS")
boxplot(deleteme$Quarterly_Tax, main = "QUARTERLY-TAX")
boxplot(deleteme$Weight, main = "WEIGHT")
pie(summary(deleteme$Mfr_Guarantee), labels = c("SI", "NO"), main = "MFR-GUARANTE")
pie(summary(deleteme$BOVAG_Guarantee), labels = c("SI", "NO"), main = "BOVAG-GUARANTE")
pie(summary(deleteme$Guarantee_Period), main="GUARANTE-PERIOD")
pie(summary(deleteme$ABS), main="ABS")
pie(summary(deleteme$Airbag_1), main = "AIRBAG-1")
pie(summary(deleteme$Airbag_2), main = "AIRBAG-2")
pie(summary(deleteme$Airco), main = "AIRCO")
pie(summary(deleteme$Automatic_airco), main = "AUTOMATIC-AIRCO")
pie(summary(deleteme$Boardcomputer), main = "BOARDCOMPUTER")
pie(summary(deleteme$CD_Player), main = "CD-PLAYER")
pie(summary(deleteme$Central_Lock), main = "CENTRAL-LOCK")
pie(summary(deleteme$Powered_Windows), main = "POWERED-WINDOWS")
pie(summary(deleteme$Power_Steering), main = "POWER-STEERING")
pie(summary(deleteme$Radio), main = "RADIO")
pie(summary(deleteme$Mistlamps), main = "MITSLAMPS")
pie(summary(deleteme$Sport_Model), main = "SPORT-MODEL")
pie(summary(deleteme$Backseat_Divider), main = "BACKSEAT-DIVIDER")
pie(summary(deleteme$Metallic_Rim), main = "METALIC-RIM")
pie(summary(deleteme$Radio_cassette), main = "RADIO-CASSETTE")
pie(summary(deleteme$Tow_Bar), main = "TOW-BAR")
pie(summary(deleteme$Power_Windows), main = "POWER-WINDOWS")
boxplot(datos$Price, main="PRICE")
boxplot(datos$KM, main="KM")
boxplot(datos$Age_08_04, main="AGE-08-04")
boxplot(datos$Mfg_Month, main="MFG-MONTH")
boxplot(datos$Mfg_Year, main="MFG-YEAR")
#boxplot(datos$Fuel_Type, main="FUEL-TYPE")
boxplot(datos$HP, main="HP")
boxplot(datos$Met_Color, main="MET-COLOR")
boxplot(datos$Automatic, main="AUTOMATIC")
boxplot(datos$cc, main="CC")
boxplot(datos$Doors, main="DOORS")
boxplot(datos$Cylinders, main="CYLINDERS")
boxplot(datos$Gears, main="GEARS")
boxplot(datos$Quarterly_Tax, main="QUARTELY-TAX")
boxplot(datos$Weight, main="WEIGHT")
boxplot(datos$Mfr_Guarantee, main="MFR-GUARANTEE")
boxplot(datos$Guarantee_Period, main="GUARANTEE-PERIOD")
boxplot(datos$ABS, main="ABS")
boxplot(datos$Airbag_1, main="AIRBAG-1")
boxplot(datos$Airbag_2, main="AIRBAG-2")
boxplot(datos$Airco, main="AIRCO")
boxplot(datos$BOVAG_Guarantee, main="BOVAG-GUARANTEE")
boxplot(datos$Automatic_airco, main="AUTOMATIC")
boxplot(datos$Boardcomputer, main="BOARDCOMPUTER")
boxplot(datos$CD_Player, main="CD-PLAYER")
boxplot(datos$Central_Lock, main="CENTRAL-LOCK")
boxplot(datos$Powered_Windows, main="POWERED-WINDOWS")
boxplot(datos$Power_Steering, main="POWERED-STEERING")
boxplot(datos$Radio, main="RADIO")
boxplot(datos$Mistlamps, main="MISTLAMPS")
boxplot(datos$Sport_Model, main="SPORT-MODEL")
boxplot(datos$Backseat_Divider, main="BACKSEAT-DIVIDER")
boxplot(datos$Metallic_Rim, main="METALLIC-RIM")
boxplot(datos$Radio_cassette, main="RADIO-CASSETTE")
boxplot(datos$Tow_Bar, main="TOW-BAR")
dataset = datos[c("Price", "KM", "Age_08_04", "HP", "cc", "Doors", "Gears", "Weight",
"Fuel_Type", "Central_Lock", "Powered_Windows","Automatic_airco")]
#dataset1 = deleteme[c("Price", "KM", "Age_08_04", "HP", "cc", "Doors", "Gears", "Weight", "Fuel_Type", "Central_Lock", "Powered_Windows")]
mlr <- lm(formula = Price ~ ., data = dataset)
summary(mlr)
dataset1 <- dataset[c("Price", "KM", "Age_08_04", "HP", "cc", "Doors", "Gears", "Weight",
"Powered_Windows","Automatic_airco")]
mlr2 <- lm(formula = Price ~ ., data =  dataset1)
summary(mlr2)
dataset3 <- dataset1[c("Price", "KM", "Age_08_04", "HP", "cc", "Gears", "Weight",
"Powered_Windows","Automatic_airco")]
mlr4 <- lm(formula = Price ~ ., data =  dataset3)
summary(mlr4)
dataset4 <- dataset3[c("Price", "KM", "Age_08_04", "HP","Gears", "Weight",
"Powered_Windows","Automatic_airco")]
mlr5 <- lm(formula = Price ~ ., data = dataset4)
summary(mlr5)
stem(mlr5$residuals)
plot(predict(mlr5), datos$Price, ylab = "Price" , main = "Valores predecidos vs actuales")
abline(a=0,b=1, col="blue", lwd=2)
plot(residuals(mlr5))
abline(a=0,b=0, col="blue", lwd =2)
hist(mlr5$residuals , main = "Histograma de residuales", freq = F)
lines(density(mlr5$residuals), col="red", lwd=2)
plot(mlr5$residuals ~ datos$Price)
abline(a=0,b=0, col = "blue", lwd=2)
qqnorm(mlr5$residuals)
qqline(mlr$residuals, col = "blue ", lwd=2)
plot(mlr5)
ggplot(dataset4, aes(x=KM, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs KM")
ggplot(dataset4, aes(x=Age_08_04, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs Age_08_04")
ggplot(dataset4, aes(x=HP, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs HP")
ggplot(dataset4, aes(x=Weight, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs Weight")
ggplot(dataset4, aes(x=Powered_Windows, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs Powered_Windows")
ggplot(dataset4, aes(x=Automatic_airco, y=Price)) + geom_point(colour = "firebrick3") +
ggtitle("Distribución Price vs Automatic_airco")
#dataset2 <- dataset[c("Price", "KM", "Age_08_04", "HP","cc","Gears", "Weight","Powered_Windows","Automatic_airco")]
#mlr3 <- lm(formula = Price ~ ., data =  dataset2)
#summary(mlr3)
#plot(mlr3)
dataset4 <- filter(dataset4, !(Weight>1200))
dataset4 <- filter(dataset4,  !(KM>150000))
dataset4 <- filter(dataset4, !(KM<15))
dataset4 <- filter(dataset4, !(HP>150))
dataset4 <- filter(dataset4, !(Age_08_04<20))
skewness(dataset4)
multi.hist(dataset4, dcol = c("blue ", "red"), dlty = c("dotted", "solid"), main = "")
pairs(dataset4)
data_correlation <- cor(dataset4)
data_correlation
corrplot(data_correlation, method="square")
dataset5 <- dataset4[c("Price", "KM", "Age_08_04", "Weight","HP",
"Powered_Windows", "Automatic_airco")]
mlr6 <- lm(formula = Price ~ ., data = dataset5)
summary(mlr6)
step(mlr6, direction = "both", trace = 1)
split_data <- createDataPartition(y= dataset5$Price, p=0.7, list= FALSE)
train_data <- dataset5[split_data,]
test_data <- dataset5[-split_data,]
lmfit1 <- train(Price ~ ., data = train_data, method="lm")
summary(lmfit1)
predict_test <- predict(lmfit1, test_data)
model_test_1 <- data.frame(obs= test_data$Price, pred = predict_test)
defaultSummary(model_test_1)
control1 <- trainControl(method="cv", number=10)
lmfit2 <- train(Price ~ ., data= dataset5, method="lm", trControl= control1, metric = "Rsquared")
summary(lmfit2)
predict_test2 <- predict(lmfit2, dataset5)
model_test_2 <- data.frame(obs=dataset5$Price, pred = predict_test2)
defaultSummary(model_test_2)
control2 <- trainControl(method= "LOOCV")
lmfit3 <- train(Price ~ ., data = dataset5, method="lm", trControl=control2)
summary(lmfit3)
predict_test3 <- predict(lmfit3, dataset5)
model_test_3 <- data.frame(obs= dataset5$Price, pred= predict_test3)
defaultSummary(model_test_3)
ggplot(varImp(lmfit3))
?skewness
